<!DOCTYPE html>
<html>
<head>
    <title>Week 3 – Log Insights</title>
    <style>
        body { font-family: Arial; margin: 30px; }
        textarea { width: 100%; height: 200px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background: #f2f2f2; }
    </style>
</head>
<body>
    <h2>Week 3 – Log Insights</h2>
    <form method="POST">
        <textarea name="log_text" placeholder="Paste logs here..."></textarea><br><br>
        <button type="submit">Analyze</button>
    </form>

    {% if summary %}
        <h3>Summary</h3>
        <p><strong>Total Lines:</strong> {{ summary.total_lines }}</p>
        <p><strong>Parsed Entries:</strong> {{ summary.parsed_entries }}</p>

        <h4>Error Distribution</h4>
        <ul>
        {% for k, v in summary.error_distribution.items() %}
            <li>{{ k }}: {{ v }}</li>
        {% endfor %}
        </ul>

        <h4>Module Distribution</h4>
        <ul>
        {% for k, v in summary.module_distribution.items() %}
            <li>{{ k }}: {{ v }}</li>
        {% endfor %}
        </ul>
    {% endif %}

    {% if results %}
        <h3>Parsed Entries</h3>
        <table>
            <tr>
                <th>Timestamp</th><th>Module</th><th>Error</th><th>IP</th><th>Raw</th>
            </tr>
            {% for r in results %}
            <tr>
                <td>{{ r.timestamp if 'timestamp' in r else '' }}</td>
                <td>{{ r.module if 'module' in r else '' }}</td>
                <td>{{ r.error if 'error' in r else '' }}</td>
                <td>{{ r.ip if 'ip' in r else '' }}</td>
                <td>{{ r.raw }}</td>
            </tr>
            {% endfor %}
        </table>
    {% endif %}
</body>
</html>
